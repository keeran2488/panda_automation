{% extends 'deshbroad/base_site.html' %}
{% block content %}

<style type="text/css">
    
    .searchBatch{
      border: 1px solid #5499C7;
    }

    a.btn:hover {
     -webkit-transform: scale(1.1);
     -moz-transform: scale(1.1);
     -o-transform: scale(1.1);
    }
   a.btn {
       -webkit-transform: scale(0.8);
       -moz-transform: scale(0.8);
       -o-transform: scale(0.8);
       -webkit-transition-duration: 0.5s;
       -moz-transition-duration: 0.5s;
       -o-transition-duration: 0.5s;
   }

</style>

           <!-- start: Content -->
            <div id="content">
               <div class="panel box-shadow-none content-header">
                  <div class="panel-body">
                    <div class="col-md-12">
                        <h3 class="animated fadeInLeft">Code Section</h3>
                        <p class="animated fadeInDown">
                          Table <span class="fa-angle-right fa"></span> List Of All Code
                        </p>
                    </div>
                  </div>
              </div>
              <div class="col-md-12 top-20 padding-0">
                <div class="col-md-12">
                  <div class="panel">
                    <div class="panel-heading"><h3>List Of Batch Code</h3></div>
                    <div class="panel-body">
                      <div class="responsive-table">
                        <div class="col-md-12 padding-0" style="margin-bottom: 10px;">

                          <!-- <div class="alert alert-info col-md-4">
                            <strong>Pendding: </strong> 
                            {% for infoTotalsales in infoTotalsales %}{{infoTotalsales.Active_count}}{% endfor %}
                          </div> -->
                            
                          <div class="alert alert-danger col-md-4">
                            <strong>Total Scan: </strong> 
                            {% for infoSalesActive in infoSalesActive %}
                              {{infoSalesActive.Active_count}}
                            {% endfor %}
                          </div>
                          <div class="alert alert-warning col-md-4">
                            <strong>Total New: </strong> 
                            {% for infoTotalNew in infoTotalNew %}
                              {{infoTotalNew.Active_count}}
                            {% endfor %}
                          </div>

                          {% if request.user.is_admin %}
                          <button type="button" class="btn btn-danger pull-right link" style="margin-left: 10px;" onclick="location.href='{% url 'delete_activation_batch' date=date product_type=product_type %}'">Delete All Data</button>
                          <button type="button" class="btn btn-primary pull-right exportBtn" onclick="location.href='{% url 'export_users_xls_batchCode' date=date product_type=product_type %}'" id="exportData">Export</button>
                          

                          


                          {% endif %}

                          <!-- Search -->
                          <div class="col-md-5 pull-right">
                              <form action="" class="search-form">
                                {% csrf_token %}
                                  <div class="form-group has-feedback">
                                    <input id="search" class="form-control searchBatch" type="search" placeholder="Search (Note:For date Search Ex: 12-01-2018)" name="searchActive">
              
                                </div>
                              </form>
                          </div>

                          <button type="button" class="btn btn-warning pull-left" onclick="location.href='{% url 'upload_activation' %}'">Upload Activation</button>

                        </div>
                        
                      <table id="datatables-example" class="table table-striped table-bordered" width="100%" cellspacing="0">
                      <thead style="color: #2C3E50; font-size: 15px;">
                        <tr>
                          <th>Upload Date</th>
                          <th>Code</th>
                          <th>Product Name</th>
                          <th>Product Point</th>
                          <th>Scan Status</th>
                          <th>Scan Date</th>
                          {% if request.user.is_admin %}
                          <th>Action</th>
                          {% endif %}
                        </tr>
                      </thead>
                      <tbody style="color: #138D75;">
                        {% for panda in panda%}
                        <tr>
                         
                          <td>{{panda.date}}</td>
                          <td>{{panda.file}}</td>
                          <td>{{panda.product_type }}</td>
                          <!-- {% for product in product %}
                            {% if product.id == panda.product_type %}
                              <td>{{panda.product_type }}</td>
                            {% endif %}
                          {% endfor %} -->
                          <td>{{panda.product_type.product_point}}</td>
                          {% if panda.active_check == True %}
                          <td><span class="label label-danger">SCAN</span></td>
                          {% else %}
                          <td><span class="label label-primary">NEW</span></td>
                          {% endif %}

                          <td>{{panda.active_date}}</td>

                          {% if request.user.is_admin %}
                          <td>
                            <a href="{% url 'delete_activation_batchCode' file=panda.file date=panda.date product_type=panda.product_type.id %}" class="btn btn-primary a-btn-slide-text center-block link">
                                 <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                  <span><strong>Delete</strong></span>            
                            </a>
                          </td>
                          {%endif%}
                        </tr>
                        {% endfor %}

                        </tbody>
                        </table>
                      </div>
                  </div>
                </div>
              </div> 

                      <!-- Start pagination -->

                {% if panda.has_other_pages %}
                  <ul class="pagination pull-right" style="margin-right: 30px; margin-bottom: 40px;"> 
                    {% if panda.has_previous %}
                      
                      <li><a href="?page={{ panda.previous_page_number }}">Previous</a></li>
                      <li><a href="?page=1">1</a></li>
                      <li><a href="?page=1">..</a></li>
                    {% else %}
                      <li class="disabled"><span>Previous</span></li>
                    {% endif %}

                    {% for i in panda.paginator.page_range %}
                      {% if panda.number == i %}
                        <li class="active"><span>{{ panda.number }} <span class="sr-only">(current)</span></span></li>
                      {% else %}
                        {% if panda.next_page_number == i and i != panda.paginator.num_pages %}
                          <li><a href="?page={{ i }}">{{ i }}</a></li>
                        {% endif %}
                        {% if panda.previous_page_number == i and i != 1%}
                          <li><a href="?page={{ i }}">{{ i }}</a></li>
                        {% endif %}
                      {% endif %}
                    {% endfor %}

                    {% if panda.has_next %}

                      <li><a href="?page=1">..</a></li>
                      <li><a href="?page={{ panda.paginator.num_pages }}"">{{ panda.paginator.num_pages }}</a></li>
                      <li><a href="?page={{ panda.next_page_number }}">Next</a></li>

                      
                    {% else %}
                      <li class="disabled"><span>Next</span></li>
                    {% endif %}
                  </ul>
                {% endif %}

              <!-- End pagination -->

              </div>
            </div>
          <!-- end: content -->

<script type="text/javascript">
      $(document).ready(function() {
       
        $(".link").popConfirm({
          title: "Delete",
          content: "Are You Sure?",
          placement: "bottom"
        });
      });
</script>

<script type="text/javascript">
  $(function(){

        $("#search").keyup(function(){
            $.ajax({
                method: 'post',
                url: "{% url 'activation_code_details' date=date product_type=product_type %}",
                data:{
                search_text : $("#search").val(),
                csrfmiddlewaretoken : $('input[name=csrfmiddlewaretoken]').val()
              },
                success: function(data) {
                    $("#datatables-example").html(data);
                    // alert(data);
                },
                error: function(e) {
                    $("#datatables-example").html(e);
                }
            });
    });

  });

  $(document).ready(function(){
    $(".exportBtn").click(function(){
      $("#exportData").html('Wait Procces To Export');
      $("#exportData").attr("disabled", true);
    });   
  });


</script>


{% endblock %}
