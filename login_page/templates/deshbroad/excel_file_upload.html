{% extends 'deshbroad/base_site.html' %}
{% block content %}

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js" integrity="sha384-FzT3vTVGXqf7wRfy8k4BiyzvbNfeYjK+frTVqZeNDFl8woCbF0CYG6g2fMEFFo/i" crossorigin="anonymous"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->


<style type="text/css">
  
  /****** CODE ******/

.file-upload{display:block;text-align:center;font-family: Helvetica, Arial, sans-serif;font-size: 12px;}
.file-upload .file-select{display:block;border: 2px solid #dce4ec;color: #16A085; font-weight: bold; cursor:pointer;height:40px;line-height:40px;text-align:left;background:#FFFFFF;overflow:hidden;position:relative;}
.file-upload .file-select .file-select-button{background:#dce4ec;padding:0 10px;display:inline-block;height:40px;line-height:40px;}
.file-upload .file-select .file-select-name{line-height:40px;display:inline-block;padding:0 10px;}
.file-upload .file-select:hover{border-color:#34495e;transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;}
.file-upload .file-select:hover .file-select-button{background:#34495e;color:#FFFFFF;transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;}
.file-upload.active .file-select{border-color:#3fa46a;transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;}
.file-upload.active .file-select .file-select-button{background:#3fa46a;color:#FFFFFF;transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;}
.file-upload .file-select input[type=file]{z-index:100;cursor:pointer;position:absolute;height:100%;width:100%;top:0;left:0;opacity:0;filter:alpha(opacity=0);}
.file-upload .file-select.file-select-disabled{opacity:0.65;}
.file-upload .file-select.file-select-disabled:hover{cursor:default;display:block;border: 2px solid #dce4ec;color: #34495e;cursor:pointer;height:40px;line-height:40px;margin-top:5px;text-align:left;background:#FFFFFF;overflow:hidden;position:relative;}
.file-upload .file-select.file-select-disabled:hover .file-select-button{background:#dce4ec;color:#666666;padding:0 10px;display:inline-block;height:40px;line-height:40px;}
.file-upload .file-select.file-select-disabled:hover .file-select-name{line-height:40px;display:inline-block;padding:0 10px;}

/*Loader*/
.loader {
  display: none;
  border: 13px solid #E74C3C;
  border-radius: 50%;
  border-top: 13px solid #45B39D;
  width: 20px;
  height: 20px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
  margin-left: 50%;
  margin-top: 5px;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/*progress*/


</style>


 <!-- start: Content -->
            <div id="content">
                <div class="panel box-shadow-none content-header">
                  <div class="panel-body">
                    <div class="col-md-12">
                        <h3 class="animated fadeInLeft">Upload Excel File</h3>
                        <p class="animated fadeInDown">
                          Upload <span class="fa-angle-right fa"></span> Excel File {{ length }}
                        </p>
                    </div>
                  </div>
                </div>
                      
            
                    <div class="col-md-12 panel-body" style="padding-bottom:30px;">
                      <div class="col-md-12" style="background: #FADBD8; padding: 30px; border-radius: 20px;">
                        <!-- <progress class="col-md-12" id="progress-bar" value="10" max="100" style="display: none; margin-bottom: 1em;"></progress> -->

                        <div class="progress" id="progress-bar" style="display: none;" >
                          <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                        </div>
                        

                        <form action="{% url 'excel_file' %}" class="cmxform" id="Activation_form" method="post" enctype="multipart/form-data">
                          {% csrf_token %}

                          <div class="col-md-8" style="margin-top: 20px;">
                              <div class="panel">
                                        <div class="panel-body">
                                            <div class="row">
                                              <div class="col-lg-12">
                                               

                                                <div class="file-upload">
                                                  <div class="file-select">
                                                    <div class="file-select-button" id="fileName">Choose File</div>
                                                   
                                                    <div class="file-select-name" id="noFile">No file chosen...</div> 
                                                    <input type="file" name="excelFile" id="chooseFile" required>
                                                  </div>
                                                </div>

                                              </div>
                                            </div>
                                             <div class="loader"></div>
                                          </div>
                                </div>
                          </div>
                          

                          <div class="col-md-12" style="margin-top: 20px; margin-right: 40px; margin-bottom: 10px;">
                              <input class="submit btn btn-primary pull-right btn-lg" type="submit" value="Upload">
                          </div>
                      </form>
                      <button class="btn btn-warning center-block" id="progress-btn" style="display: none;" onclick="location.reload();">Back</button>

                      <div id="confirm">
                               <div class="message" id="messageID">Successfully Upload File</div><br>
                               <button class="yes btn btn-primary">OK</button>
                      </div>
<!-- <input type="button" value="Click Me" onclick="functionAlert();" /> -->

                    </div>
                  </div>
                </div>

<!-- Alert Box -->

      <style>
         #confirm {
            display: none;
            background-color: #FDFEFE;
            color: #000000;
            /*border: 1px solid #aaa;*/
            position: fixed;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            width: 300px;
            height: 100px;
            left: 50%;
            top: 50%;
            box-sizing: border-box;
            text-align: center;
         }
         
         #confirm .message {
            text-align: center;
            font-weight: bold;
            /*background: #EAEDED;*/
            color: #E74C3C;
            display: block;
            margin-top: 15px;
         }
</style>

<script>
         function functionAlert(msg, myYes) {
            var confirmBox = $("#confirm");
            confirmBox.find(".message").text(msg);
            confirmBox.find(".yes").unbind().click(function() {
               confirmBox.hide();
            });
            confirmBox.find(".yes").click(myYes);
            confirmBox.show();
            
         }
      </script>

<script type="text/javascript">

  $('#chooseFile').bind('change', function () {
  var filename = $("#chooseFile").val();
  var textType = /text.*/;
  var fileInput = document.getElementById('chooseFile');
  var file = fileInput.files[0];

  if (file.type.match(textType)) {
    $(".file-upload").addClass('active');
    $("#noFile").text(filename.replace("C:\\fakepath\\", ""));
    $(".loader").show();
    document.getElementById("messageID").innerHTML = "Successfully Upload File";
    upload();
  }
  else {
    document.getElementById("messageID").innerHTML = "Excel File";
    functionAlert();
    var data = new FormData($('form').get(0));
    // alert('Please Upload Text File');
    $(".file-upload").addClass('active');
    $("#noFile").text(filename.replace("C:\\fakepath\\", ""));
    // $(".loader").show();
    // upload();
  }
});



</script>

{% endblock %}
